@(user: securesocial.core.Identity,
  evaluation: Evaluation,
  brand: Brand)(implicit request: Request[Any], flash: Flash, handler: AuthorisationHandler, token: play.filters.csrf.CSRF.Token)

@import helper.CSRF
@import views.Evaluations
@import templates.Formatters._
@import be.objectify.deadbolt.scala.views.html._
@import be.objectify.deadbolt.core.utils.TemplateUtils._

@main("Evaluation for %s".format(evaluation.participant.fullName), Some(user)) {

  @common.evaluationActions()
  <div class="span8">
    <header>
      <h1>Evaluation for @evaluation.participant.fullName
          @dynamic(handler, "evaluation", "edit") {
          <a class="btn-small btn"href="@routes.Evaluations.edit(evaluation.id.get)"><i class="icon-pencil"></i> Edit</a>
        }
      </h1>
    </header>
  </div>
  @dynamic(handler, "evaluation", "manage") {
    <div class="span2 actions">
      @if(evaluation.status == EvaluationStatus.Approved && brand.generateCert) {
        <a class="btn btn-default btn-block" tabindex="-1"
          href="@CSRF(routes.Certificates.create(evaluation.id.getOrElse(0)))"
          type="submit">
            <i class="icon-white icon-file"></i> Generate Certificate
        </a><br/>
        <div class="clearfix"></div>
      }
      @if(evaluation.status != EvaluationStatus.Approved) {
        <a class="approve btn btn-success btn-block" tabindex="-1" href="#approve"
          data-href="@CSRF(routes.Evaluations.approve(evaluation.id.getOrElse(0)))"
          data-toggle="modal" type="submit">
            <i class="icon-white icon-thumbs-up"></i> Approve
        </a><br/>
        <div class="clearfix"></div>
      }
      @if(evaluation.status != EvaluationStatus.Rejected) {
        <a class="reject btn btn-warning btn-block" tabindex="-1" href="#reject"
          data-href="@CSRF(routes.Evaluations.reject(evaluation.id.getOrElse(0)))"
          data-toggle="modal" type="submit">
            <i class="icon-white icon-thumbs-down"></i> Reject
        </a><br/>
        <div class="clearfix"></div>
      }
      <form class="delete" method="get" text="evaluation"
        action="@CSRF(routes.Evaluations.delete(evaluation.id.getOrElse(0)))">
        <button class="btn btn-danger btn-block" type="submit">
          <i class="icon-white icon-trash"></i> Delete
        </button>
      </form>
    </div>
  }

  <div class="span8">
    <div class="span3">
      <p>
        <strong>Event</strong><br/>
        <a href="@routes.Events.details(evaluation.event.id.get)">@evaluation.event.title</a>
      </p>
    </div>
    <div class="span2">
      <strong>@Messages("evaluation.question6")</strong><br/>
      @Messages("evaluation.impression." + evaluation.question6)
    </div>
    <div class="span2">
      <strong>Recommendation</strong><br/>
      @Messages("evaluation.recommendation." + evaluation.question7)
    </div>
  </div>
  <div class="span8">
    <div class="span3">
      <p>
        <strong>Status</strong><br/>
        <span class="label @Messages("models.EvaluationStatus." + evaluation.status + ".label")">
          @Messages("models.EvaluationStatus." + evaluation.status)</span>
      </p>
    </div>
    <div class="span2">
      @if(evaluation.status != EvaluationStatus.Pending) {
        @evaluation.handled.map { value =>
          <strong>Handled Date</strong><br/>@value
        }
      }
    </div>
    <div class="span2">
      @if(evaluation.status == EvaluationStatus.Approved) {
        @evaluation.certificate.map { value =>
          <strong>Certificate #</strong><br/>
          <a href="@routes.Certificates.certificate(value)" target="_blank">@value</a>
        }
      }
    </div>
  </div>
  <div class="span8">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Question</th>
            <th>Answer</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>@Messages("evaluation.question1")</td>
            <td>@evaluation.question1</td>
          </tr>
          <tr>
            <td>@Messages("evaluation.question2")</td>
            <td>@evaluation.question2</td>
          </tr>
          <tr>
            <td>@Messages("evaluation.question3")</td>
            <td>@evaluation.question3</td>
          </tr>
          <tr>
            <td>@Messages("evaluation.question4")</td>
            <td>@evaluation.question4</td>
          </tr>
          <tr>
            <td>@Messages("evaluation.question5")</td>
            <td>@evaluation.question5</td>
          </tr>
          <tr>
            <td>@Messages("evaluation.question8")</td>
            <td>@evaluation.question8</td>
          </tr>
        </tbody>
      </table>
  </div>
  <script src="@routes.Assets.at("evaluation/details.js")" type="text/javascript"></script>
}
