@(user: ActiveUser,
    id: Option[Long],
    people: List[Person],
    form: Form[Brand])(implicit flash: Flash,
    request: Request[Any],
    handler: AuthorisationHandler,
    token: play.filters.csrf.CSRF.Token)

  @import helper.CSRF
  @import views.ViewHelpersV2._
  @import models.Person

  @defining(form.value.map(brand => "Edit Brand").getOrElse("Add brand")) { name =>
    @v2.main("Brand", "brands", user, withMelly = true) {
        <div class="form">
            @v2.html.form(action = CSRF(id.map(x => routes.Brands.update(x)).getOrElse(routes.Brands.create())),
                'enctype -> "multipart/form-data") {
                @v2.html.block("") {
                    <h1>@name</h1>
                }
                @v2.html.block("General") {
                    @v2.html.text(form("code"), '_label -> "Code", '_required -> true)
                    @v2.html.text(form("uniqueName"), '_label -> "Unique name", '_required -> true,
                        '_help -> "This name is used on HM website in an address of brand's landing page")
                    @v2.html.text(form("name"), '_label -> "Name", '_required -> true, '_help -> "")
                    @v2.html.text(form("tagLine"), '_label -> "Tagline")
                    @v2.html.select(form("ownerId"),
                        ("", "Choose brand owner") :: people.map(p => (p.id.get.toString, p.fullName)),
                        '_label -> "Owner", '_required -> true, '_help -> "")
                }
                @v2.html.block("Description", Some("grey")) {
                    @v2.html.textarea(form("description"), '_label -> "Description", 'rows -> 5,
                        '_type -> views.html.element.markdownHelp())
                    @v2.html.file(form("picture"), '_label -> "Picture")
                }
                @v2.html.block("On the Web", Some("yellow")) {
                    @v2.html.text(form("webSite"), '_label -> "Web site")
                    @v2.html.text(form("blog"), '_label -> "Blog")
                    <input type="hidden" name="@form("generateCert").name" value="@form("generateCert").value.exists(_.toBoolean)">
                    @v2.html.email(form("email"), '_label -> "E-mail address", '_required -> true, '_help -> "")
                }
                @v2.html.block("Social Profile") {
                    @defining(form("profile.twitterHandle")) { field =>
                        <div class="form-group @if(field.hasErrors) {has-error}" id="@(field.id + "_field")">
                            <label for="@field.id" class="col-sm-2 control-label">
                                Twitter</label>
                            <div class="col-sm-7">
                                <div class="input-group">
                                    <span class="input-group-addon">@@</span>
                                    <input type="text" id="@field.id" name="@field.name"
                                    value="@field.value.getOrElse("")"
                                    placeholder="MyTwitter"
                                    class="form-control">
                                </div>
                            </div>
                        </div>
                    }
                    @v2.html.text(form("profile.facebookUrl"), '_label -> "Facebook Page",
                        'placeholder -> "http://www.facebook.com/brand.page", '_help -> "")
                    @v2.html.text(form("profile.linkedInUrl"), '_label -> "LinkedIn Page",
                        'placeholder -> "https://www.linkedin.com/in/brand.page", '_help -> "")
                    @v2.html.text(form("profile.googlePlusUrl"), '_label -> "Google+ Page",
                        'placeholder -> "https://plus.google.com/0123456789", '_help -> "")
                    @v2.html.text(form("profile.skype"), '_label -> "Skype", '_help -> "")
                    @v2.html.text(form("profile.phone"), '_label -> "Phone", '_help -> "")
                    @v2.html.text(form("profile.contactForm"), '_label -> "Link to contact form ", '_help -> "")
                }
                @v2.html.block("Hooks", Some("grey")) {
                    @v2.html.text(form("evaluationUrl"), '_label -> "Evaluation Url",
                        'placeholder -> "http://yourwebsite.com/evaluation",
                        '_help -> "")
                    @v2.html.text(form("evaluationHookUrl"), '_label -> "Evaluation Hook",
                        'placeholder -> "http://yourwebsite.com/evaluation/confirm",
                        '_help -> "")
                }
                @if(form.hasErrors) {
                    @v2.html.block("") {
                        <div class="errors">
                        @for((error, index) <- form.errors.zipWithIndex) {
                            @{index + 1}. @play.api.i18n.Messages(error.message)<br/>
                        }
                        </div>
                    }
                }
                @v2.html.block("") {
                    <div class="row">
                        <div class="col-md-5">
                            <button class="btn btn-primary btn-block btn-lg" type="submit">
                                Save</button>
                        </div>
                        <div class="col-md-3 cancel">
                            <a href="javascript:history.back()">Cancel changes</a></div>
                    </div>
                }
            }
        </div>
    }
  }
