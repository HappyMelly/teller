@(org: Organisation,
    width: String)(implicit request: Request[Any],
    handler: AuthorisationHandler,
    token: play.filters.csrf.CSRF.Token)

@import be.objectify.deadbolt.scala.views.html._
@import models.UserRole.DynamicRole

<div class="b-avatar @if(org.logo) { b-avatar_stat_real }">
@dynamicOr(handler, DynamicRole.OrgMember, org.identifier.toString) {
    @if(org.logo) {
      <div id="real">
        <img width="@width" class="b-avatar__img"
        src="@Organisations.logoUrl(org.identifier)"/>
      </div>
    }

    <div id="stub" @if(org.logo) { style="display:none;" }>
      <a href="#" class="choosePhotoLink" data-toggle="modal" data-target="#photoDialog">
        <img width="@width" class="b-avatar__img"
          src="@routes.Assets.at("images/add-logo.png")"/></a>
    </div>

    <div class="b-avatar__action">
      <a href="#"
        class="link-white choosePhotoLink"
        data-toggle="modal"
        data-target="#photoDialog">
          Edit
      </a>
      <a href="#"
        class="link-white"
        id="btnLogoDelete"
        data-href="@routes.Organisations.deleteLogo(org.identifier)">
        Delete
      </a>
    </div>
  } {
    @if(org.logo) {
      <img id="photo" width="@width" class="b-avatar__img"
      src="@Organisations.logoUrl(org.identifier)"/>
    } else {
      <img id="photo" width="@width" class="b-avatar__img"
        src="@routes.Assets.at("images/add-logo.png")"/>
    }
  }
</div>

@dynamic(handler, DynamicRole.OrgMember, org.identifier.toString) {
  <div id="photoDialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div id="choosePhotoContent">
    @v2.html.alert("photoDialog",
      "Update logo", small = false) {
        <div class="b-photoupload">
          <div class="b-photoupload__item" id="custom">
            @if(org.logo) {
              <img class="b-photoupload__img"  width="250" id="logo" src="@Organisations.logoUrl(org.identifier)"/>
            } else {
              <img class="b-photoupload__img"  width="250" id="logo" src="@routes.Assets.at("images/happymelly-face-white.png")"/>
            }
            <div class="b-photoupload__desc">
              <br/>
              <div class="b-fileupload">
                <button type="button" class="btn btn-primary b-fileupload__btn">Choose File</button>
                <div class="b-fileupload__label">No file chosen</div>
                <input type="file"
                  id="logoUpload"
                  class="b-fileupload__ctr"
                  name="logo"
                  data-url="@routes.Organisations.uploadLogo(org.identifier)"/>
              </div>

              <button class="btn btn-upload" id="btnLogoUpload">Upload</button>
              <br/>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
}
