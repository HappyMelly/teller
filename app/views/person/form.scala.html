@(user: securesocial.core.Identity,
  id: Option[Long],
  form: Form[Person])(implicit flash: Flash, token: play.filters.csrf.CSRF.Token)

@import helper.CSRF
@import views.Countries
@import views.ViewHelpers._

@defining(form.value.map(person => "Person %s %s".format(person.firstName, person.lastName)).getOrElse("Add person")) { personName =>
  @main("Person", Some(user)) {
    @if(form.hasErrors) {
        @elements.error()
    }

    <div class="col-md-6">
      <div class="page-header">
        <h1>@personName</h1>
      </div>
  	  @helper.form(action = CSRF(id.map(id => routes.People.update(id)).getOrElse(routes.People.create())),
        'class -> "form-horizontal") {
        @helper.inputText(form("firstName"), '_label -> "First name", 'class -> "form-control")
        @helper.inputText(form("lastName"), '_label -> "Last name", 'class -> "form-control")
        @helper.inputText(form("emailAddress"), '_label -> "E-mail address", 'class -> "form-control")
        @helper.inputText(form("address.street1"), '_label -> "Address line 1", 'class -> "form-control")
        @helper.inputText(form("address.street2"), '_label -> "Address line 2", 'class -> "form-control")
        @helper.inputText(form("address.postCode"), '_label -> "Post code", 'class -> "form-control")
        @helper.inputText(form("address.city"), '_label -> "City", 'class -> "form-control")
        @helper.inputText(form("address.province"), '_label -> "Province or state", 'class -> "form-control")
        @helper.select(form("address.country"), ("", "Choose a country") :: Countries.all, '_label -> "Country", 'class -> "form-control")
        @helper.textarea(form("bio"), '_label -> "Bio", 'class -> "form-control input-xxlarge", 'rows -> "5", '_help -> views.html.markdownHelp())
        @helper.textarea(form("interests"), '_label -> "Interests", 'class -> "form-control input-xxlarge", 'rows -> "5", '_help -> views.html.markdownHelp())

        <input type="hidden" value="@form("photo").value.getOrElse("")" id="photo" name="photo"/>

        @defining(form("profile.twitterHandle")) { field =>
          <div class="form-group @if(field.hasErrors) {has-error}" id="@(field.id + "_field")">
            <label for="@field.id" class="col-sm-3 control-label">Twitter user name</label>
            <div class="col-sm-9">
              <div class="input-group col-sm-9">
                <span class="input-group-addon">@@</span>
                <input type="text" id="@field.id" name="@field.name"
                  value="@field.value.getOrElse("")"
                  placeholder="MyTwitter"
                  class="form-control">
              </div>
              <span class="help-block">
                @if(field.hasErrors) {
                  @field.errors.map(error => Messages(error.message)).mkString(", ")
                }
              </span>
            </div>
          </div>
        }

        @defining(form("profile.facebookUrl")) { field =>
          <div class="form-group @if(field.hasErrors) {has-error}" id="@(field.id + "_field")">
            <label for="@field.id" class="col-sm-3 control-label">Facebook profile</label>
            <div class="col-sm-9">
              <div class="input-group">
                <input type="text" id="@field.id" class="form-control"
                  name="@field.name" value="@field.value.getOrElse("")"
                  placeholder="http://www.facebook.com/my.profile">
                <span class="input-group-btn">
                  <button class="btn btn-success photo-button" type="button"
                    id="facebook">Get Facebook Photo</button>
                </span>
              </div>
              <span class="help-block">
                @if(field.hasErrors) {
                  @field.errors.map(error => Messages(error.message)).mkString(", ")
                }
              </span>
            </div>
          </div>
        }
        @helper.inputText(form("profile.linkedInUrl"),
          '_label -> "LinkedIn profile",
          'class -> "form-control input-xxlarge",
          'placeholder -> "https://www.linkedin.com/in/my.profile",
          '_help -> "")
        @helper.inputText(form("profile.googlePlusUrl"),
          '_label -> "Google+ profile",
          'class -> "form-control input-xxlarge",
          'placeholder -> "https://plus.google.com/0123456789",
          '_help -> "")

        <div class="form-group" id="boardMember_field">
          <label for="boardMember" class="checkbox col-sm-3">Board member</label>
          <div class="col-sm-9">
            <input type="checkbox" id="boardMember" name="boardMember"
              value="true" class="form-control col-sm-9"
              @if(form("boardMember").value.exists(_ == "true")){checked}>
          </div>
        </div>

        <div class="form-group" id="stakeholder_field">
          <label for="stakeholder" class="checkbox col-sm-3">Stakeholder</label>
          <div class="col-sm-9">
            <input type="checkbox" id="stakeholder" name="stakeholder"
              value="true" class="form-control"
              @if(form("stakeholder").value.exists(_ == "true")){checked}>
          </div>
        </div>

        @helper.inputText(form("webSite"), '_label -> "Web site",
          'placeholder -> "http://", '_help -> "Web site URL",
          'class -> "form-control")
        @helper.inputText(form("blog"), '_label -> "Blog",
          'placeholder -> "http://", '_help -> "Web site URL",
          'class -> "form-control")

        <div clas="row">
          <div class="col-sm-3"></div>
          <div class="col-sm-9">
            <button class="btn btn-primary btn-block pull-right" type="submit">Save</button>
          </div>
        </div>
      }
      </div>
  }
  <script src="@routes.Assets.at("person/form.js")" type="text/javascript"></script>
}
