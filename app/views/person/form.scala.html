@(user: securesocial.core.Identity,
  id: Option[Long],
  form: Form[Person])(implicit flash: Flash, token: play.filters.csrf.CSRF.Token)

@import helper.CSRF
@import views.Countries
@import views.ViewHelpers._

@defining(form.value.map(person => "Person %s %s".format(person.firstName, person.lastName)).getOrElse("Add person")) { personName =>
  @main("Person", Some(user)) {
    @if(form.hasErrors) {
        @html.error()
    }

    <div class="col-md-6">
      <div class="page-header">
        <h1>@personName</h1>
      </div>
      @html.form(action = CSRF(id.map(id => routes.People.update(id)).getOrElse(routes.People.create()))) {
        @html.text(form("firstName"), '_label -> "First name")
        @html.text(form("lastName"), '_label -> "Last name")
        @html.email(form("emailAddress"), '_label -> "E-mail address")
        @html.text(form("address.street1"), '_label -> "Address line 1")
        @html.text(form("address.street2"), '_label -> "Address line 2")
        @html.text(form("address.postCode"), '_label -> "Post code")
        @html.text(form("address.city"), '_label -> "City")
        @html.text(form("address.province"), '_label -> "Province or state")
        @html.select(form("address.country"), ("", "Choose a country") :: Countries.all, '_label -> "Country")
        @html.textarea(form("bio"), '_label -> "Bio", 'rows -> "5", '_help -> views.html.markdownHelp())
        @html.textarea(form("interests"), '_label -> "Interests", 'rows -> "5", '_help -> views.html.markdownHelp())

        <input type="hidden" value="@form("photo").value.getOrElse("")" id="photo" name="photo"/>

        @defining(form("profile.twitterHandle")) { field =>
          <div class="form-group @if(field.hasErrors) {has-error}" id="@(field.id + "_field")">
            <label for="@field.id" class="col-sm-3 control-label">Twitter user name</label>
            <div class="col-sm-9">
              <div class="input-group">
                <span class="input-group-addon">@@</span>
                <input type="text" id="@field.id" name="@field.name"
                  value="@field.value.getOrElse("")"
                  placeholder="MyTwitter"
                  class="form-control">
              </div>
              <span class="help-block">
                @if(field.hasErrors) {
                  @field.errors.map(error => Messages(error.message)).mkString(", ")
                }
              </span>
            </div>
          </div>
        }

        @defining(form("profile.facebookUrl")) { field =>
          <div class="form-group @if(field.hasErrors) {has-error}" id="@(field.id + "_field")">
            <label for="@field.id" class="col-sm-3 control-label">Facebook profile</label>
            <div class="col-sm-9">
              <div class="input-group">
                <input type="text" id="@field.id" class="form-control"
                  name="@field.name" value="@field.value.getOrElse("")"
                  placeholder="http://www.facebook.com/my.profile">
                <span class="input-group-btn">
                  <button class="btn btn-success photo-button" type="button"
                    id="facebook">Get Facebook Photo</button>
                </span>
              </div>
              <span class="help-block">
                @if(field.hasErrors) {
                  @field.errors.map(error => Messages(error.message)).mkString(", ")
                }
              </span>
            </div>
          </div>
        }
        @html.text(form("profile.linkedInUrl"), '_label -> "LinkedIn profile",
          'placeholder -> "https://www.linkedin.com/in/my.profile", '_help -> "")
        @html.text(form("profile.googlePlusUrl"), '_label -> "Google+ profile",
          'placeholder -> "https://plus.google.com/0123456789", '_help -> "")

        @html.checkbox(form("boardMember"), '_label -> "Board Member", '_help -> "")
        @html.checkbox(form("stakeholder"), '_label -> "Stakeholder", '_help -> "")

        @html.text(form("webSite"), '_label -> "Web site",
          'placeholder -> "http://", '_help -> "Web site URL")
        @html.text(form("blog"), '_label -> "Blog",
          'placeholder -> "http://", '_help -> "Web site URL")

        <div clas="row">
          <div class="col-sm-3"></div>
          <div class="col-sm-9">
            <button class="btn btn-primary btn-block pull-right" type="submit">Save</button>
          </div>
        </div>
      }
      </div>
  }
  <script src="@routes.Assets.at("person/form.js")" type="text/javascript"></script>
}
