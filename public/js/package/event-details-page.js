!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(41)},,,function(e,t){"use strict";t.__esModule=!0,t["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var a=n(5),i=r(a);t["default"]=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i["default"])(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){e.exports={"default":n(6),__esModule:!0}},function(e,t,n){n(7);var r=n(10).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(8);r(r.S+r.F*!n(18),"Object",{defineProperty:n(14).f})},function(e,t,n){var r=n(9),a=n(10),i=n(11),o=n(13),l="prototype",u=function(e,t,n){var s,c,f,d=e&u.F,v=e&u.G,h=e&u.S,p=e&u.P,m=e&u.B,_=e&u.W,y=v?a:a[t]||(a[t]={}),$=y[l],k=v?r:h?r[t]:(r[t]||{})[l];v&&(n=t);for(s in n)c=!d&&k&&void 0!==k[s],c&&s in y||(f=c?k[s]:n[s],y[s]=v&&"function"!=typeof k[s]?n[s]:m&&c?i(f,r):_&&k[s]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[l]=e[l],t}(f):p&&"function"==typeof f?i(Function.call,f):f,p&&((y.virtual||(y.virtual={}))[s]=f,e&u.R&&$&&!$[s]&&o($,s,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.2.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(12);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(14),a=n(22);e.exports=n(18)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(15),a=n(17),i=n(21),o=Object.defineProperty;t.f=n(18)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),a)try{return o(e,t,n)}catch(l){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(16);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(18)&&!n(19)(function(){return 7!=Object.defineProperty(n(20)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){e.exports=!n(19)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){var r=n(16),a=n(9).document,i=r(a)&&r(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},function(e,t,n){var r=n(16);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=r(a),o=n(4),l=r(o),u=function(){function e(t){(0,i["default"])(this,e),this.$controls=t,this.arrErrors=[],this._assignEvents()}return(0,l["default"])(e,[{key:"_assignEvents",value:function(){var e=this;this.$controls.on("input change",function(t){var n=$(t.currentTarget);e._validateImmediate(n),e._removeError(n)})}},{key:"_validateImmediate",value:function(e){e.hasClass("type-numeric")&&e.val(e.val().replace(/[^\d]+/g,""))}},{key:"isValidInputs",value:function(){var e=this,t=this.$controls,n=0;return t.each(function(t,r){var a=$(r);e._isValidInput(a)||(n+=1)}),Boolean(!n)}},{key:"_isValidInput",value:function(e){var t=$.trim(e.val());return t||e.hasClass("type-optional")?e.hasClass("type-email")&&!this._isValidEmail(t)?(this._setError(e,"Email is not valid"),!1):!0:(this._setError(e,"Empty"),!1)}},{key:"_isValidEmail",value:function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}},{key:"_setError",value:function(e,t){var n=e.parent(),r=n.find(".b-error");r.length||(n.addClass("b-error_show"),$('<div class="b-error" />').text(t).appendTo(n),this.arrErrors.push({name:e.attr("name"),error:t}))}},{key:"_removeError",value:function(e){var t=e.parent();t.removeClass("b-error_show").find(".b-error").remove(),this.arrErrors=this.arrErrors.filter(function(t){return t.name!==e.attr("name")})}},{key:"setErrors",value:function(e){var t=this;e.forEach(function(e){var n=t.$controls.filter('[name="'+e.name+'"]').first();n.length&&t._setError(n,e.error)})}},{key:"getErrorsText",value:function(e){var t=e||this.arrErrors,n="";return t.forEach(function(e){var t=e.name[0].toUpperCase()+e.name.substr(1);n+=t+": "+e.error+". "}),n}},{key:"getErrorsFull",value:function(e){var t=e||this.arrErrors,n=$("body"),r="";return t.forEach(function(e){var t=n.find('input[name="'+e.name+'"]').first(),a=t.length?t.attr("title"):e.name;r+="<b>"+a+"</b>: "+e.error+".  <br><br>"}),r}},{key:"getFormData",value:function(){var e={};return this.$controls.map(function(t,n){var r=$(n),a=r.attr("name");a&&(e[a]=r.val())}),e}},{key:"removeErrors",value:function(){var e=this;this.$controls.each(function(t,n){var r=$(n);e._removeError(r)})}},{key:"getFormData",value:function(){var e={};return this.$controls.map(function(t,n){var r=$(n),a=r.attr("name");a&&(e[a]=r.val())}),e}},{key:"clearForm",value:function(){this.$controls.each(function(e,t){var n=$(t);n.attr("disabled")||n.val("")})}}]),e}();t["default"]=u},,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=r(a),o=n(4),l=r(o),u=function(){function e(t){(0,i["default"])(this,e),this.$root=$(t),this.locals=this._getDom(),this.$confirmDialog=null,this._assignEvents()}return(0,l["default"])(e,[{key:"_getDom",value:function(){return{$confirm:this.$root.find("[data-event-confirm]"),$cancel:this.$root.find("[data-event-cancel]")}}},{key:"_assignEvents",value:function(){this.$root.on("click","[data-event-confirm]",this._onClickConfirm.bind(this)).on("click","[data-event-cancel]",this._onClickCancel.bind(this)).on("click","#eventCancelButton",this._onClickAcceptCancel.bind(this))}},{key:"_onClickConfirm",value:function(e){e.preventDefault();var t=this,n=t.locals.$confirm.data("id");t._sendConfirm(n).done(function(){t.locals.$confirm.addClass("disabled").text("Confirmed").off("click"),success("Event was successfully confirmed")})}},{key:"_onClickCancel",value:function(e){e.preventDefault();var t=this,n=t.locals.$cancel.data("id");t._sendCancel(n).done(function(e){t.$confirmDialog=t._createDialog(e),t.$confirmDialog.modal("show")})}},{key:"_onClickAcceptCancel",value:function(e){e.preventDefault();var t=this,n=$("#cancelForm").serialize(),r=t.locals.$cancel.data("id");t._sendAcceptCancel(n,r).done(function(){t.$confirmDialog.on("hidden.bs.modal",function(){App.events.pub("hmt.event.cancel")}).modal("hide"),success("Event was successfully canceled")})}},{key:"_createDialog",value:function(e){var t="#cancelDialog",n=void 0;return $(t).remove(),n=$('<div id="'+t+'" class="b-modal modal fade" tabindex="-1">').attr("role","dialog").attr("aria-hidden","true").append(e),n.appendTo(this.$root),n}},{key:"_sendConfirm",value:function(e){var t=jsRoutes.controllers.cm.Events.confirm(e).url;return $.post(t,{})}},{key:"_sendCancel",value:function(e){var t=jsRoutes.controllers.cm.Events.reason(e).url;return $.get(t,{})}},{key:"_sendAcceptCancel",value:function(e,t){var n=jsRoutes.controllers.cm.Events.cancel(t).url;return $.post(n,e)}}],[{key:"plugin",value:function(t){var n=$(t);if(n.length)return n.each(function(t,n){var r=$(n),a=r.data("hmt.event.block");a||(a=new e(n),r.data("widget",a))})}}]),e}();t["default"]=u},,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=n(35),i=r(a),o=n(42),l=r(o),u=n(43),s=r(u),c=n(44),f=r(c);$(function(){i["default"].plugin(".js-event-controls"),s["default"].plugin(".js-request-evaluation"),l["default"].plugin(".js-clipboard"),f["default"].plugin(".js-modify-email"),App.events.sub("hmt.event.cancel",function(){var e=$("#brandId").val();window.location.replace(jsRoutes.controllers.cm.Events.index(e).url)})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=r(a),o=n(4),l=r(o),u=function(){function e(t){return(0,i["default"])(this,e),this.root=t,this.$root=$(t),ZeroClipboard?(this.client=new ZeroClipboard(t),void this._assignEvents()):void console.log("there is no zeroclipboard dependency")}return(0,l["default"])(e,[{key:"_assignEvents",value:function(){this.client.on("ready",this._onEventReady.bind(this)).on("aftercopy",this._onEventAfter.bind(this))}},{key:"_onEventReady",value:function(){}},{key:"_onEventAfter",value:function(){var e=this,t=e.$root;t.addClass("state_copied").attr("title","Copied").tooltip("show"),setTimeout(function(){t.tooltip("hide").attr("title","").attr("data-original-title","").removeClass("state_copied")},2500)}}],[{key:"plugin",value:function(t){var n=$(t);if(n.length)return n.each(function(t,n){var r=$(n),a=r.data("widget-clipboard");a||(a=new e(n),r.data("widget",a))})}}]),e}();t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=r(a),o=n(4),l=r(o),u=function(){function e(t){(0,i["default"])(this,e),this.$root=$(t),this.locals=this._getDom(),this.template=_.template($("#request-dlg-template").html()),this._checkFormValidation(),this._assignEvent()}return(0,l["default"])(e,[{key:"_getDom",value:function(){var e=this.$root;return{$listParticipants:e.find("[data-requesteval-list]"),$textarea:e.find("[data-requesteval-textarea]"),$filterLinks:e.find("[data-requesteval-filter]"),$submit:e.find("[data-requesteval-submit]")}}},{key:"_assignEvent",value:function(){var e=this;this.$root.on("change","[data-requesteval-list] input",this._checkFormValidation.bind(this)).on("input propertychange","[data-requesteval-textarea]",this._checkFormValidation.bind(this)).on("click","[data-requesteval-filter]",function(t){t.preventDefault();var n=$(t.currentTarget);e._filterParticipants(n)}),App.events.sub("hmt.requestDlg.render",this._renderCheckboxes.bind(this))}},{key:"_checkFormValidation",value:function(){var e=this.locals,t=this.$root.find("[data-requesteval-list] input"),n=!0;t.filter(":checked").length||(n=!1),/https?:/i.test(e.$textarea.val())||(n=!1),n?e.$submit.removeAttr("disabled"):e.$submit.attr("disabled","disabled")}},{key:"_renderCheckboxes",value:function(e){var t=e.table._("tr",{}),n=void 0,r=void 0;for(n=0,r=t.length;r>n;n++){var a={index:n,value:t[n].person.id,name:t[n].person.name,status:$.isPlainObject(t[n].evaluation.status)},i=this.template(a);this.locals.$listParticipants.append(i)}}},{key:"_filterParticipants",value:function(e){var t=this.$root.find("[data-requesteval-list] input"),n=e.data("requesteval-filter"),r=this.locals.$filterLinks;if(!e.hasClass("state_selected")){switch(n){case"all":t.prop("checked",!0);break;case"with":t.prop("checked",!1).filter(".have-evaluation").prop("checked",!0);break;case"without":t.prop("checked",!0).filter(".have-evaluation").prop("checked",!1);break;default:t.prop("checked",!1)}r.removeClass("state_selected"),e.addClass("state_selected"),this._checkFormValidation()}}}],[{key:"plugin",value:function(t){var n=$(t);if(n.length)return n.each(function(t,n){var r=$(n),a=r.data("hmt.events.upcoming");a||(a=new e(n),r.data("widget",a))})}}]),e}();t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=r(a),o=n(4),l=r(o),u=n(23),s=r(u),c=function(){function e(t){(0,i["default"])(this,e),this.$root=$(t),this.locals=this._getDom(),this.formHelper=new s["default"](this.locals.$textarea),this._assignEvent()}return(0,l["default"])(e,[{key:"_getDom",value:function(){var e=this.$root;return{$link:e.find("[data-emailmod-link]"),$modal:e.find("[data-emailmod-dlg]"),$form:e.find("[data-emailmod-form]"),$textarea:e.find("[data-emailmod-textarea]"),$cancel:e.find("[data-emailmod-cancel]")}}},{key:"_assignEvent",value:function(){this.$root.on("click","[data-emailmod-link]",this._onClickShowModal.bind(this)).on("click","[data-emailmod-mark]",this._onClickUseTemplate.bind(this)).on("click","[data-emailmod-cancel]",this._onClickCancel.bind(this)),this.locals.$form.on("submit",this._onSubmitForm.bind(this))}},{key:"_onClickShowModal",value:function(e){e.preventDefault(),this.locals.$modal.modal("show")}},{key:"_onClickUseTemplate",value:function(e){e.preventDefault()}},{key:"_onClickCancel",value:function(e){e.preventDefault(),this.formHelper.clearForm(),this.formHelper.removeErrors(),this.locals.$modal.modal("hide")}},{key:"_onSubmitForm",value:function(e){e.preventDefault();var t=this;if(t.formHelper.isValidInputs()){var n=t.formHelper.getFormData();t._sendEmailContent(n).done(function(){t.formHelper.clearForm(),t.locals.$modal.modal("hide"),success("Email is modified")}).fail(function(e){var n=$.parseJSON(e.responseText).data;n.errors&&t.formHelper.setErrors(n.errors)})}}},{key:"_sendEmailContent",value:function(e){var t=this.locals.$form.attr("action");return $.post(t,e)}}],[{key:"plugin",value:function(t){var n=$(t);if(n.length)return n.each(function(t,n){var r=$(n),a=r.data("hmt.events.modify_email");a||(a=new e(n),r.data("widget",a))})}}]),e}();t["default"]=c}]);